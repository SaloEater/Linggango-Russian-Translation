name: Create Release with 7z Archive

on: push

jobs:
  release:
    name: Create Release
    permissions: write-all # this is the FIX
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Prepare build structure
        run: |
          mkdir -p build_temp
          cp -r config build_temp/
          cp -r kubejs build_temp/
          mkdir -p build_temp/resourcepacks

          echo "üì¶ files to build:"
          ls -la build_temp/

      - name: Create resource pack zip
        run: |
          cd "resourcepacks/Community Russian Translations"
          zip -r ../../build_temp/resourcepacks/Community_RussianTranslations.zip .
          cd ../..

      - name: Create 7z archive
        uses: edgarrc/action-7z@v1
        with:
          args: 7z a -t7z -mx=9 CommunityRussianTranslation.7z ./build_temp/* -r

      - name: Create GitHub Release
        uses: softprops/action-gh-release@v1
        with:
          tag_name: 1.0
          name: –†—É—Å—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥
          files: CommunityRussianTranslation.7z
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}